# Malware-File-Classification
The model finds the class of malware the file belongs to if it is a malware file.
<h1><a href="https://web.cs.hacettepe.edu.tr/~selman/malevis/">Dataset</a></h1>
    <p>The datasets used here were collected from the MaleVis dataset.</p>
<h3>Sample snapshots of the dataset:</h3>
<img src="https://user-images.githubusercontent.com/81440360/185743074-26c42816-a0b0-4dd2-905a-b840db469e0a.png" alt="Grayscale images of executable files">
<img src="https://user-images.githubusercontent.com/81440360/185743140-f637de5b-cd2f-4ce2-8ba0-28cb5922fb07.png" alt="Grayscale images of executable files">

<h1>Phases involved:</h1>
<img src="https://user-images.githubusercontent.com/81440360/185743467-06c32a7d-0749-4b04-a764-66401625dbb4.png" alt="Phases">
<h3>Phase 1:</h3>
<p>The first phase is known as the analysis phase in which the collected datasets were pre-processed by converting the portable executable data files into visualized grayscale images. The visualized grayscale images are resized by changing its dimensions into 30 x 90 to minimize the space taken and information loss.</p>

<h3>Phase 2:</h3>
<p>The second phase is known as the classification phase where we use our two main algorithms namely the sliding window and cascading layer approach.</p>

<h4>(i) Sliding window scanning stage:</h4>
<p>The resized images are scanned using a sliding window of size 4 X 4. Sliced images are generated by passing the input dimensions, sliding window size, and stride value into the sliding window algorithm and are appended one by one into an array. These images are then processed by RF and CRF classifiers giving us the probability distribution over classes for the given image. This outcome, called as feature vectors, will further be pushed into the next phase of the project.</p>
<img src="https://user-images.githubusercontent.com/81440360/185743666-181ba1de-ae14-4627-976c-baaba88c046a.png" alt="Sliding Window">

<h4>(ii) Cascade Layering Stage:</h4>
<p>The obtained feature vectors from the sliding window will be feeded as input to the cascading layering algorithm. Each layer is comprised of a group of ensembles (group of decision trees) which when a feature vector is passed generates class vectors. This is again concatenated with the passed feature vector and is passed to the next layer.  At each layer, 5-fold cross validation is carried out to check the accuracy achieved and decide whether this process should proceed further or not. If accuracy dips, layering stops. The class probability vector obtained in each layer is averaged to obtain the final prediction probability vector. The class, which shows the highest probability, is the correct matching class for the given input image.</p>
<img src="https://user-images.githubusercontent.com/81440360/185743813-6c8d47d5-5937-4539-be73-8e62f37995da.png" alt="Cascade Layering">

<p>This is implemented based on the research paper <a href="https://ieeexplore.ieee.org/document/9250472">Intelligent Vision-Based Malware Detection and Classification Using Deep Random Forest Paradigm.</a> </p>

<h1>Predictions:</h1>
<img src="https://user-images.githubusercontent.com/81440360/185744031-4ceb0ada-71d4-47a9-918f-d25deee03f0b.png" alt="Prediction">


